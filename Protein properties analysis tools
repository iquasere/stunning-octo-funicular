#Saves swissprot register  
def select_swissprot_entries(gb_fs,ficheiro):                               #file is table retrieved from uniprot
    handle = open(ficheiro)
    swiss_record = [record for record in SwissProt.parse(handle)]
    entries = list()
    for ft in gb_fs:
        if ft.type == 'CDS':
            for entry in swiss_record:
                for ref in entry.cross_references:
                    if ref[0] == 'RefSeq':
                        if 'protein_id' in ft.qualifiers.keys():
                            if ref[1] == ft.qualifiers['protein_id'][0]:
                                entries.append(entry)
    return entries
    
#Selects reviewed entries
def swissprot_reviewed(sp_entries):                                         #sp_entries is result from previous function
    r_entries = list()
    for entry in sp_entries:
        if entry.data_class == 'Reviewed':
            r_entries.append(entry)
    return r_entries
    
#Search in pdb database entries corresponding to study's proteins
def pdb():
    pdb_ids = list()
    f = open('pdb_database.txt')
    file = f.readlines()
    for ss in sse:
        for access in ss.accessions:
            for line in file:
                if access in line:
                    pdb_id = line.split()[0]
                    for ref in ss.cross_references:
                        if ref[0] == 'RefSeq':
                            pdb_ids.append((ref[1],pdb_id))
    f.close()
    return pdb_ids

#Retrieve information from pdb
def create_pdb_files():
    pdbl = PDB.PDBList()
    for match in pdb():
        pdbl.retrieve_pdb_file(match)
